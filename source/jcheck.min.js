/*!
// iPhone-style Checkboxes jQuery plugin
// Copyright Thomas Reynolds, licensed GPL & MIT
*/
(function(b,a){b[a]=function(d,c){this.$elem=b(d);var e=this;b.each(c,function(f,g){e[f]=g});this.wrapCheckboxWithDivs();this.attachEvents();this.disableTextSelection();if(this.resizeHandle){this.optionallyResize("handle")}if(this.resizeContainer){this.optionallyResize("container")}this.initialPosition()};b.extend(b[a].prototype,{wrapCheckboxWithDivs:function(){this.$elem.wrap('<div class="'+this.containerClass+'" />');this.container=this.$elem.parent();this.offLabel=b('<label class="'+this.labelOffClass+'"><span>'+this.uncheckedLabel+"</span></label>").appendTo(this.container);this.offSpan=this.offLabel.children("span");this.onLabel=b('<label class="'+this.labelOnClass+'"><span>'+this.checkedLabel+"</span></label>").appendTo(this.container);this.onSpan=this.onLabel.children("span");this.handle=b('<div class="'+this.handleClass+'"><div class="'+this.handleRightClass+'"><div class="'+this.handleCenterClass+'" /></div></div>').appendTo(this.container)},disableTextSelection:function(){if(!b.browser.msie){return}b.each([this.handle,this.offLabel,this.onLabel,this.container],function(c){b(c).attr("unselectable","on")})},optionallyResize:function(f){var c=this.onLabel.width(),d=this.offLabel.width(),e=(c<d)?c:d;if(f=="container"){e+=this.handle.width()+15}this[f].css({width:e})},attachEvents:function(){var c=this;this.container.bind("mousedown touchstart",function(e){e.preventDefault();if(c.$elem.is(":disabled")){return}var d=e.pageX||e.changedTouches[0].pageX;b[a].currentlyClicking=c.handle;b[a].dragStartPosition=d-(parseInt(c.handle.css("left"),10)||0)}).bind("iPhoneDrag",function(e,d){e.preventDefault();if(c.$elem.is(":disabled")){return}var f=(d-b[a].dragStartPosition)/c.rightSide;if(f<0){f=0}if(f>1){f=1}c.handle.css({left:f*c.rightSide});c.onLabel.css({width:f*c.rightSide+4});c.offSpan.css({marginRight:-f*c.rightSide});c.onSpan.css({marginLeft:-(1-f)*c.rightSide})}).bind("iPhoneDragEnd",function(e,d){if(c.$elem.is(":disabled")){return}if(b[a].dragging){var f=(d-b[a].dragStartPosition)/c.rightSide;c.$elem.attr("checked",(f>=0.5))}else{c.$elem.attr("checked",!c.$elem.attr("checked"))}b[a].currentlyClicking=null;b[a].dragging=null;c.$elem.change()});this.$elem.change(function(){if(c.$elem.is(":disabled")){c.container.addClass(c.disabledClass)}else{c.container.removeClass(c.disabledClass)}var d=c.$elem.attr("checked")?c.rightSide:0;c.onChange();c.handle.animate({left:d},c.duration);c.onLabel.animate({width:d+4},c.duration);c.offSpan.animate({marginRight:-d},c.duration);c.onSpan.animate({marginLeft:d-c.rightSide},c.duration)})},initialPosition:function(){this.offLabel.css({width:this.container.width()-5});var c=(b.browser.msie&&b.browser.version<7)?3:6;this.rightSide=this.container.width()-this.handle.width()-c;if(this.$elem.is(":checked")){this.handle.css({left:this.rightSide});this.onLabel.css({width:this.rightSide+4});this.offSpan.css({marginRight:-this.rightSide})}else{this.onLabel.css({width:0});this.onSpan.css({marginLeft:-this.rightSide})}if(this.$elem.is(":disabled")){this.container.addClass(this.disabledClass)}}});b.fn[a]=function(c){var e=this.filter(":checkbox");if(!e.length){return this}var d=b.extend({},b[a].defaults,c);e.each(function(){b(this).data(a,new b[a](this,d))});if(!b[a].initComplete){b(document).bind("mousemove touchmove",function(g){if(!b[a].currentlyClicking){return}if(g.pageX!=b[a].dragStartPosition){b[a].dragging=true}g.preventDefault();var f=g.pageX||g.changedTouches[0].pageX;b(g.target).trigger("iPhoneDrag",[f])}).bind("mouseup touchend",function(g){if(!b[a].currentlyClicking){return}g.preventDefault();var f=g.pageX||g.changedTouches[0].pageX;b(b[a].currentlyClicking).trigger("iPhoneDragEnd",[f])});b[a].initComplete=true}return this};b[a].defaults={duration:200,checkedLabel:"ON",uncheckedLabel:"OFF",resizeHandle:true,resizeContainer:true,disabledClass:"iPhoneCheckDisabled",containerClass:"iPhoneCheckContainer",labelOnClass:"iPhoneCheckLabelOn",labelOffClass:"iPhoneCheckLabelOff",handleClass:"iPhoneCheckHandle",handleCenterClass:"iPhoneCheckHandleCenter",handleRightClass:"iPhoneCheckHandleRight",onChange:function(){return false}}})(jQuery,"iphoneStyle");